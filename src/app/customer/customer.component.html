<div class="container">
    <br>
    <div class="col-md-6">
      <div class="card-header">
         Customer Form
      </div>
      <div class="card-body">
       <form  (ngSubmit)="save()" novalidate [formGroup]="customerForm">
           <div class="form-group">

            <input type="text" 
                   class="form-control"  
                   formControlName="CustomerCode" hidden  />
            <div class="col-md-12">
                <label>Name</label>
                <input type="text" 
                       class="form-control"  
                       formControlName="Name"  
                       [ngClass]="{'is-invalid':  ((customerForm.get('Name')?.touched ||
                                                    customerForm.get('Name')?.dirty) &&
                                                    !customerForm.get('Name')?.valid) }" />
                      <span class="invalid-feedback">
                       <span *ngIf="customerForm.get('Name')?.errors?.required">
                         Please enter your name.
                       </span>
                       <span *ngIf="customerForm.get('Name')?.errors?.minlength">
                         The name must be longer than 3 characters.
                       </span>
                     </span>
             </div>
           </div>


           <div class="form-group">
            <div class="col-md-12">
                <label>Email</label>
                <input type="text" 
                       class="form-control"  
                       formControlName="Email"  
                       [ngClass]="{'is-invalid': (customerForm.get('Email')?.touched ||
                                                  customerForm.get('Email')?.dirty) &&
                                                 !customerForm.get('Email')?.valid }" />
                      <span class="invalid-feedback">
                       <span *ngIf="customerForm.get('Email')?.errors?.required">
                         Please enter your email.
                       </span>
                       <span *ngIf="customerForm.get('Email')?.errors?.email">
                        Please enter your email in correct format
                       </span>
                     </span>
             </div>
           </div>

           <div class="form-group">

            <div class="col-md-12">
                <label >Location </label>
                <br>
                <div class="form-check-inline" *ngFor="let country of countries | async">
                   <input class="form-check-input" 
                          type="radio" 
                          formControlName="Location"
                          value="{{country}}"
                          [ngClass]="{'is-invalid': (customerForm.get('Location')?.touched ||
                                                     customerForm.get('Location')?.dirty) &&
                                                    !customerForm.get('Location')?.valid }"
                         > 

                         <span class="invalid-feedback">
                          <span *ngIf="customerForm.get('Location')?.errors?.required">
                            Please select your location.
                          </span>
                          
                        </span>
                          {{ country }}
                </div>
                      <span class="invalid-feedback">
                       <span *ngIf="customerForm.get('Name')?.errors?.required">
                         Please enter your name.
                       </span>
                       <span *ngIf="customerForm.get('Name')?.errors?.minlength">
                         The name must be longer than 3 characters.
                       </span>
                     </span>
             </div>
           </div>

           <div class="form-group">
            <label>Level</label>
            <br>
            <select class="form-select" 
            formControlName="Level"  
            [ngClass]="{'is-invalid': (customerForm.get('Level')?.touched ||
                                       customerForm.get('Level')?.dirty) &&
                                      !customerForm.get('Level')?.valid }"   
                      >
                <option value="">--Select--</option>
                <option value="{{level}}" *ngFor="let level of levels | async">{{ level }}</option>
            </select>
            <span class="invalid-feedback">
              <span *ngIf="customerForm.get('Level')?.errors?.required">
                Please select employee type
              </span>
             
            </span>
        </div>

           <br>
           <br>

           <div class="col-md-12">
             <button class="btn btn-success" [disabled]="customerForm.invalid">Click</button>
           </div>

       </form>
      </div>
    </div>

<br>Dirty: {{ customerForm.dirty }}
<br>Touched: {{ customerForm.touched }}
<br>Valid: {{ customerForm.valid }}
<br>Value: {{ customerForm.value | json }}
</div>

<br>
<br>
<br>


  <p-table #dt [value]="listOfCustomers" 
  *ngIf='listOfCustomers.length'
      styleClass="p-datatable-customers" 
    [rowHover]="true"
    [rows]="10" 
    [showCurrentPageReport]="true" 
    [rowsPerPageOptions]="[5,10,25,50]" 
    [paginator]="true" 
    [loading]="loading"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" 
    [style]="{'width':'100%','overflow':'auto!important'}"
    [globalFilterFields]="['Name','Email','Location', 'Level']"
 >

 <ng-template pTemplate="caption">
  <div style="text-align: right">
      <i class="pi pi-search" style="margin:4px 4px 0 0"></i>
      <input pInputText 
             type="text" 
             (input)="applyFilterGlobal($event, 'contains')" 
             placeholder="Filter" />


  </div>
</ng-template> 
<ng-template pTemplate="header">
<tr>
  <th [pSortableColumn]="'Name'">Name
    <p-sortIcon [field]="'Name'"></p-sortIcon>
  </th>
  <th [pSortableColumn]="'Email'">Email
    <p-sortIcon [field]="'Email'"></p-sortIcon>
  </th>
  <th [pSortableColumn]="'Location'">Location
    <p-sortIcon [field]="'Location'"></p-sortIcon>
  </th>
  <th [pSortableColumn]="'Level'">Level
    <p-sortIcon [field]="'Level'"></p-sortIcon>
  </th>
</tr>
</ng-template>
<ng-template class="ui-widget-header" pTemplate="body" let-customer>
<tr>
<td>{{ customer.Name }}</td>
<td>{{ customer.Email }}</td>
<td>{{ customer.Location }}</td>
<td>{{ customer.Level }}</td>
<td>
 <button class="btn btn-danger" (click)="deleteCustomer(customer.CustomerCode)" >
   Delete
 </button>
</td>
<td>
 <button class="btn btn-danger" [routerLink]="['/edit', customer.CustomerCode]" >
   Edit
 </button>
</td>
</tr>
</ng-template>
<ng-template pTemplate="emptymessage">
<tr>
<td colspan="8">No customers found.</td>
</tr>
</ng-template>
</p-table>





<br>
<br>
<br>
<br>